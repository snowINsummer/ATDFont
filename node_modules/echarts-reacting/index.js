import React from 'react';
import ec from 'echarts';
import deep from 'deep';

var EcharsReact = React.createClass({
    render() {
        return  <div 
            ref = "me"
            style = { Object.assign({ width: 100, height: 100 }, this.props.style) }> 
        </div>;
    },
    componentDidMount() {
        this.echart = ec.init(this.refs.me);
        this.echart.setOption(this.props.option);
        this.echart.on("click", this.props.onClick);
        window.addEventListener("resize", this.echart.resize);
    },
    shouldComponentUpdate(nextProps) {
        return !deep.equals(this.props.option,nextProps.option);
    },
    componentDidUpdate() {
        this.echart.setOption(this.props.option);
    },
    componentWillUnmount() {
        window.removeEventListener("resize", this.echart.resize);
    }
});

export default EcharsReact;
